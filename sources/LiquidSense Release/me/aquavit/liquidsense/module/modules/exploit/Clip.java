package me.aquavit.liquidsense.module.modules.exploit;

import me.aquavit.liquidsense.module.Module;
import me.aquavit.liquidsense.module.ModuleCategory;
import me.aquavit.liquidsense.module.ModuleInfo;
import me.aquavit.liquidsense.value.FloatValue;
import me.aquavit.liquidsense.value.ListValue;
import net.minecraft.client.network.NetHandlerPlayClient;
import net.minecraft.network.play.client.C03PacketPlayer;

@ModuleInfo(name = "Clip", description = "Allows you to clip through blocks.", category = ModuleCategory.EXPLOIT, canEnable = false)
public class Clip extends Module {
    private ListValue modeValue = new ListValue("Mode", new String[]{"Teleport", "Flag"}, "Teleport");
    private FloatValue horizontalValue = new FloatValue("Horizontal", 0F, -10F, 10F);
    private FloatValue verticalValue = new FloatValue("Vertical", 5F, -10F, 10F);

    @Override
    public void onEnable() {
        if (mc.thePlayer == null)return;

        double yaw = Math.toRadians(mc.thePlayer.rotationYaw);
        double x = -Math.sin(yaw) * horizontalValue.get();
        double z = Math.cos(yaw) * horizontalValue.get();

        switch (modeValue.get()){
            case "Teleport":
                mc.thePlayer.setPosition(mc.thePlayer.posX + x, mc.thePlayer.posY + verticalValue.get(),
                        mc.thePlayer.posZ + z);
                break;
            case "Flag": {
                NetHandlerPlayClient netHandler = mc.getNetHandler();

                netHandler.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(mc.thePlayer.posX,
                        mc.thePlayer.posY, mc.thePlayer.posZ, true));
                netHandler.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(0.5, 0.0,
                        0.5, true));
                netHandler.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(mc.thePlayer.posX,
                        mc.thePlayer.posY, mc.thePlayer.posZ, true));
                netHandler.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(mc.thePlayer.posX + x,
                        mc.thePlayer.posY + verticalValue.get(), mc.thePlayer.posZ + z, true));
                netHandler.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(0.5,
                        0.0, 0.5, true));
                netHandler.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(mc.thePlayer.posX
                        + 0.5, mc.thePlayer.posY, mc.thePlayer.posZ + 0.5, true));

                mc.thePlayer.setPosition(mc.thePlayer.posX + -Math.sin(yaw) * 0.04, mc.thePlayer.posY,
                        mc.thePlayer.posZ + Math.cos(yaw) * 0.04);
                break;
            }
        }
    }
}
