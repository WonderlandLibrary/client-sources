package com.alan.clients.module.impl.exploit.disabler;

import com.alan.clients.component.impl.player.RotationComponent;
import com.alan.clients.component.impl.player.rotationcomponent.MovementFix;
import com.alan.clients.event.Listener;
import com.alan.clients.event.Priorities;
import com.alan.clients.event.annotations.EventLink;
import com.alan.clients.event.impl.input.MoveInputEvent;
import com.alan.clients.event.impl.motion.PreUpdateEvent;
import com.alan.clients.module.impl.exploit.Disabler;
import com.alan.clients.util.player.MoveUtil;
import com.alan.clients.util.vector.Vector2f;
import com.alan.clients.value.Mode;

public class OmniSprintDisabler extends Mode<Disabler> {

    public OmniSprintDisabler(String name, Disabler parent) {
        super(name, parent);
    }

    private float forward, strafe;

    @EventLink(value = Priorities.HIGH)
    Listener<MoveInputEvent> moveInput = event -> {
        forward = event.getForward();
        strafe = event.getStrafe();
    };

    @EventLink(value = Priorities.LOW)
    Listener<PreUpdateEvent> onPreUpdate = event -> {
        if (mc.thePlayer == null || mc.theWorld == null) {
            return;
        }

        RotationComponent.setRotations(new Vector2f((float) Math.toDegrees(MoveUtil.direction(forward, strafe)), mc.thePlayer.rotationPitch),
                10, MovementFix.NORMAL);
    };
}